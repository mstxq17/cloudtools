<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xq17.cloudtools.mapper.FileStoreMapper">
  
    <!-- 全部字段 -->
    <sql id="allColumn">fileStoreId, userId, currentSize, maxSize, email, permission</sql>
    
    <!-- 插入新的仓库 -->
    <insert id="addFileStore"  useGeneratedKeys="true" keyProperty="fileStoreId">
    	insert into file_store(userId) values (#{userId});
    </insert>
    
    <select  id="getFileStoreById" parameterType="Integer" resultType="FileStore">
    	select 
	    <include refid="allColumn"></include>
	    from file_store
	    <where>
	        fileStoreId = #{id}
	    </where>
    </select>
    
    <!--  增加仓库size -->
    <update id="addSize">
        update file_store set currentSize = currentSize + #{size}
        <where>
            fileStoreId = #{id}
        </where>
    </update>
    
    <!-- 减少仓库size -->
    <update id="subSize">
        update file_store set currentSize = currentSize - #{size}
        <where>
            fileStoreId = #{id}
        </where>
    </update>
    
    <!--  修改最大仓库容量 -->
    <update id="changeMaxSize">
        update file_store set maxSize = #{maxSize}
        <where>
            fileStoreId = #{id}
        </where>
    </update>
</mapper>